{"version":3,"file":"wolfram-notebook-embedder.js","sources":["../node_modules/promise-polyfill/src/finally.js","../node_modules/promise-polyfill/src/index.js","../src/main.js"],"sourcesContent":["/**\n * @this {Promise}\n */\nfunction finallyConstructor(callback) {\n  var constructor = this.constructor;\n  return this.then(\n    function(value) {\n      return constructor.resolve(callback()).then(function() {\n        return value;\n      });\n    },\n    function(reason) {\n      return constructor.resolve(callback()).then(function() {\n        return constructor.reject(reason);\n      });\n    }\n  );\n}\n\nexport default finallyConstructor;\n","import promiseFinally from './finally';\n\n// Store setTimeout reference so promise-polyfill will be unaffected by\n// other code modifying setTimeout (like sinon.useFakeTimers())\nvar setTimeoutFunc = setTimeout;\n\nfunction noop() {}\n\n// Polyfill for Function.prototype.bind\nfunction bind(fn, thisArg) {\n  return function() {\n    fn.apply(thisArg, arguments);\n  };\n}\n\n/**\n * @constructor\n * @param {Function} fn\n */\nfunction Promise(fn) {\n  if (!(this instanceof Promise))\n    throw new TypeError('Promises must be constructed via new');\n  if (typeof fn !== 'function') throw new TypeError('not a function');\n  /** @type {!number} */\n  this._state = 0;\n  /** @type {!boolean} */\n  this._handled = false;\n  /** @type {Promise|undefined} */\n  this._value = undefined;\n  /** @type {!Array<!Function>} */\n  this._deferreds = [];\n\n  doResolve(fn, this);\n}\n\nfunction handle(self, deferred) {\n  while (self._state === 3) {\n    self = self._value;\n  }\n  if (self._state === 0) {\n    self._deferreds.push(deferred);\n    return;\n  }\n  self._handled = true;\n  Promise._immediateFn(function() {\n    var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n    if (cb === null) {\n      (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n      return;\n    }\n    var ret;\n    try {\n      ret = cb(self._value);\n    } catch (e) {\n      reject(deferred.promise, e);\n      return;\n    }\n    resolve(deferred.promise, ret);\n  });\n}\n\nfunction resolve(self, newValue) {\n  try {\n    // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n    if (newValue === self)\n      throw new TypeError('A promise cannot be resolved with itself.');\n    if (\n      newValue &&\n      (typeof newValue === 'object' || typeof newValue === 'function')\n    ) {\n      var then = newValue.then;\n      if (newValue instanceof Promise) {\n        self._state = 3;\n        self._value = newValue;\n        finale(self);\n        return;\n      } else if (typeof then === 'function') {\n        doResolve(bind(then, newValue), self);\n        return;\n      }\n    }\n    self._state = 1;\n    self._value = newValue;\n    finale(self);\n  } catch (e) {\n    reject(self, e);\n  }\n}\n\nfunction reject(self, newValue) {\n  self._state = 2;\n  self._value = newValue;\n  finale(self);\n}\n\nfunction finale(self) {\n  if (self._state === 2 && self._deferreds.length === 0) {\n    Promise._immediateFn(function() {\n      if (!self._handled) {\n        Promise._unhandledRejectionFn(self._value);\n      }\n    });\n  }\n\n  for (var i = 0, len = self._deferreds.length; i < len; i++) {\n    handle(self, self._deferreds[i]);\n  }\n  self._deferreds = null;\n}\n\n/**\n * @constructor\n */\nfunction Handler(onFulfilled, onRejected, promise) {\n  this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n  this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n  this.promise = promise;\n}\n\n/**\n * Take a potentially misbehaving resolver function and make sure\n * onFulfilled and onRejected are only called once.\n *\n * Makes no guarantees about asynchrony.\n */\nfunction doResolve(fn, self) {\n  var done = false;\n  try {\n    fn(\n      function(value) {\n        if (done) return;\n        done = true;\n        resolve(self, value);\n      },\n      function(reason) {\n        if (done) return;\n        done = true;\n        reject(self, reason);\n      }\n    );\n  } catch (ex) {\n    if (done) return;\n    done = true;\n    reject(self, ex);\n  }\n}\n\nPromise.prototype['catch'] = function(onRejected) {\n  return this.then(null, onRejected);\n};\n\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  // @ts-ignore\n  var prom = new this.constructor(noop);\n\n  handle(this, new Handler(onFulfilled, onRejected, prom));\n  return prom;\n};\n\nPromise.prototype['finally'] = promiseFinally;\n\nPromise.all = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!arr || typeof arr.length === 'undefined')\n      throw new TypeError('Promise.all accepts an array');\n    var args = Array.prototype.slice.call(arr);\n    if (args.length === 0) return resolve([]);\n    var remaining = args.length;\n\n    function res(i, val) {\n      try {\n        if (val && (typeof val === 'object' || typeof val === 'function')) {\n          var then = val.then;\n          if (typeof then === 'function') {\n            then.call(\n              val,\n              function(val) {\n                res(i, val);\n              },\n              reject\n            );\n            return;\n          }\n        }\n        args[i] = val;\n        if (--remaining === 0) {\n          resolve(args);\n        }\n      } catch (ex) {\n        reject(ex);\n      }\n    }\n\n    for (var i = 0; i < args.length; i++) {\n      res(i, args[i]);\n    }\n  });\n};\n\nPromise.resolve = function(value) {\n  if (value && typeof value === 'object' && value.constructor === Promise) {\n    return value;\n  }\n\n  return new Promise(function(resolve) {\n    resolve(value);\n  });\n};\n\nPromise.reject = function(value) {\n  return new Promise(function(resolve, reject) {\n    reject(value);\n  });\n};\n\nPromise.race = function(values) {\n  return new Promise(function(resolve, reject) {\n    for (var i = 0, len = values.length; i < len; i++) {\n      values[i].then(resolve, reject);\n    }\n  });\n};\n\n// Use polyfill for setImmediate for performance gains\nPromise._immediateFn =\n  (typeof setImmediate === 'function' &&\n    function(fn) {\n      setImmediate(fn);\n    }) ||\n  function(fn) {\n    setTimeoutFunc(fn, 0);\n  };\n\nPromise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n  if (typeof console !== 'undefined' && console) {\n    console.warn('Possible Unhandled Promise Rejection:', err); // eslint-disable-line no-console\n  }\n};\n\nexport default Promise;\n","import PromisePolyfill from 'promise-polyfill';\n\nconst globalNS = (function() {\n    if (typeof self !== 'undefined') {\n        return self;\n    }\n    if (typeof window !== 'undefined') {\n        return window;\n    }\n    if (typeof global !== 'undefined') {\n        return global;\n    }\n    throw new Error('Unable to locate global object');\n})();\n\nconst Promise = globalNS.Promise || PromisePolyfill;\n\nconst installedScripts = {};\nconst libraryLoading = {};\nlet counter = 0;\nlet isStyleInsertionPatched = false;\nconst insertedStyles = [];\nconst styleInsertionCallbacks = [];\n\nfunction installScript(url) {\n    if (!installedScripts[url]) {\n        const script = document.createElement('script');\n        script.type = 'text/javascript';\n        script.src = url;\n        const head = document.getElementsByTagName('head')[0];\n        head.appendChild(script);\n        installedScripts[url] = true;\n    }\n}\n\nfunction loadLibrary(libraryURL) {\n    if (!libraryLoading[libraryURL]) {\n        libraryLoading[libraryURL] = new Promise((resolve, reject) => {\n            const script = document.createElement('script');\n            script.type = 'text/javascript';\n            script.onerror = reject;\n            let callbackName;\n            do {\n                callbackName = '_wolframNotebookEmbedderCallback' + (++counter);\n            } while (window[callbackName]);\n            window[callbackName] = (lib) => {\n                delete window[callbackName];\n                resolve(lib);\n            };\n            script.src = libraryURL + '?callback=' + callbackName;\n            const head = document.getElementsByTagName('head')[0];\n            head.appendChild(script);\n        });\n    }\n    return libraryLoading[libraryURL];\n}\n\n/**\n * Splits a string into two parts at the first occurrence of any of the given separators.\n * @param s String to split.\n * @param separators Array of separators. Whichever separator occurs first in the string\n * is where the split happens.\n * @returns The part before the separator and the part after it.\n * If no separator occurs in the string, `[null, null]` is returned.\n */\nfunction split(s, separators) {\n    let before = null;\n    let after = null;\n    for (let i = 0; i < separators.length; ++i) {\n        const sep = separators[i];\n        const index = s.indexOf(sep);\n        if (index >= 0 && (before === null || index < before.length)) {\n            before = s.substring(0, index);\n            after = s.substring(index + sep.length);\n        }\n    }\n    return [before, after];\n}\n\nfunction isNotebookStyleElement(element, domains) {\n    const name = element.tagName.toLowerCase();\n    if (name === 'link' && (element.rel === 'stylesheet' || element.type === 'text/css')) {\n        return domains.some(domain => element.href.startsWith(domain));\n    } else if (name === 'style') {\n        if (element.dataset.isWolframNotebookStyle) {\n            return true;\n        }\n        if (element.id === 'erd_scroll_detection_scrollbar_style') {\n            return true;\n        }\n    }\n    return false;\n}\n\nfunction patchShadowStyleInsertion(container, domains) {\n    function callback(element) {\n        // When inserting the style element for the first time, use the original element,\n        // to make sure that onload and onerror handlers are preserved.\n        // For subsequent insertions (second embedded notebook and beyond), clone the element.\n        const styleElement = !element.didInsertWithoutCloning ? element : element.cloneNode(true);\n        element.didInsertWithoutCloning = true;\n        container.appendChild(styleElement);\n    }\n\n    if (!isStyleInsertionPatched) {\n        const head = document.getElementsByTagName('head')[0];\n        if (head) {\n            const originalAppendChild = head.appendChild;\n            head.appendChild = function (child) {\n                if (isNotebookStyleElement(child, domains)) {\n                    insertedStyles.push(child);\n                    styleInsertionCallbacks.forEach(callback => {\n                        callback(child);\n                    });\n                } else {\n                    originalAppendChild.call(this, child);\n                }\n            };\n        }\n        isStyleInsertionPatched = true;\n    }\n\n    insertedStyles.forEach(existingStyle => {\n        callback(existingStyle);\n    });\n    styleInsertionCallbacks.push(callback);\n    const index = styleInsertionCallbacks.length - 1;\n    return () => {\n        styleInsertionCallbacks.splice(index, 1);\n    };\n}\n\nfunction getNotebookData(url) {\n    const [domain, remainingPaths] = split(url, ['/obj/', '/objects/']);\n    if (!domain || !remainingPaths) {\n        throw new Error('InvalidCloudObjectURL');\n    }\n    // For now the query string is simply pruned.\n    const path = remainingPaths.split('?', 1)[0];\n    if (!path) {\n        throw new Error('InvalidCloudObjectURL');\n    }\n    const embeddingAPI = domain + '/notebooks/embedding?path=' + path;\n    return new Promise((resolve, reject) => {\n        // Use XMLHttpRequest instead of fetch to be compatible with older browsers.\n        const req = new XMLHttpRequest();\n        req.addEventListener('load', () => {\n            if (req.status === 200) {\n                const text = req.responseText;\n                const data = JSON.parse(text);\n                resolve({\n                    notebookID: data.notebookID,\n                    mainScript: domain + data.mainScript,\n                    otherScripts: (data.otherScripts || []).map(script => domain + script),\n                    stylesheetDomains: [domain, ...data.stylesheetDomains]\n                });\n            } else {\n                reject(new Error('ResolveError'));\n            }\n        });\n        req.addEventListener('error', () => {\n            reject(new Error('RequestError'));\n        });\n        req.addEventListener('abort', () => {\n            reject(new Error('RequestAborted'));\n        });\n        req.open('GET', embeddingAPI);\n        req.send();\n    });\n}\n\nfunction defaultValue(value, fallback) {\n    if (value === undefined) {\n        return fallback;\n    } else {\n        return value;\n    }\n}\n\nexport function embed(url, node, options) {\n    let theNotebookID;\n    const theOptions = options || {};\n    const {useShadowDOM = false} = theOptions;\n    const useShadow = useShadowDOM && node.attachShadow;\n    let container;\n    let shadowRoot;\n\n    // The list of nodes that have their dimensions updated\n    // when the notebook container dimensions are supposed to change.\n    // The CloudPlatform code will currently also update the node's dimensions,\n    // but still include it here, just to be sure.\n    const containerNodes = [node];\n\n    const cleanupHandlers = [];\n\n    function onContainerDimensionsChange({width, height}) {\n        containerNodes.forEach(containerNode => {\n            if (width != null) {\n                containerNode.style.width = `${width}px`;\n            }\n            if (height != null) {\n                containerNode.style.height = `${height}px`;\n            }\n        });\n    }\n\n    return Promise.resolve()\n        .then(() => {\n            if (useShadow) {\n                const shadowHost = document.createElement('div');\n                shadowHost.style.width = '100%';\n                shadowHost.style.height = '100%';\n                shadowRoot = shadowHost.attachShadow({mode: 'open'});\n                container = document.createElement('div');\n                container.style.width = '100%';\n                container.style.height = '100%';\n                node.appendChild(shadowHost);\n\n                // Workaround to make React's event handling work,\n                // as suggested in https://github.com/facebook/react/issues/9242#issuecomment-534096832\n                // This makes the shadow root appear like a \"normal document\", so React can use it\n                // for creating elements and registering event handlers.\n                // Otherwise, React event handlers wouldn't fire since events don't bubble up from\n                // the shadow DOM to the top document.\n                Object.defineProperty(container, 'ownerDocument', { value: shadowRoot });\n                shadowRoot.createElement = (...args) => document.createElement(...args);\n                shadowRoot.createElementNS = (...args) => document.createElementNS(...args);\n                shadowRoot.createTextNode = (...args) => document.createTextNode(...args);\n                shadowRoot.createDocumentFragment = (...args) => document.createDocumentFragment(...args);\n\n                // Needed by jQuery, particularly $(...).offset.\n                shadowRoot.documentElement = container;\n                shadowRoot.defaultView = window;\n\n                containerNodes.push(shadowHost);\n                containerNodes.push(container);\n\n                shadowRoot.appendChild(container);\n            } else {\n                container = node;\n            }\n            return getNotebookData(url);\n        })\n        .then(({notebookID, mainScript, otherScripts, stylesheetDomains}) => {\n            if (useShadow) {\n                const cleanup = patchShadowStyleInsertion(shadowRoot, stylesheetDomains);\n                cleanupHandlers.push(cleanup);\n            }\n            theNotebookID = notebookID;\n            for (let i = 0; i < otherScripts.length; ++i) {\n                installScript(otherScripts[i]);\n            }\n            return loadLibrary(mainScript);\n        })\n        .then(lib => {\n            return lib.embed(theNotebookID, container, {\n                width: defaultValue(theOptions.width, null),\n                maxHeight: defaultValue(theOptions.maxHeight, Infinity),\n                allowInteract: defaultValue(theOptions.allowInteract, true),\n                showRenderProgress: defaultValue(theOptions.showRenderProgress, true),\n                onContainerDimensionsChange\n            });\n        })\n        .then(embedding => {\n            return {\n                ...embedding,\n                detach: () => {\n                    embedding.detach();\n                    cleanupHandlers.forEach(cleanup => {\n                        cleanup();\n                    });\n                },\n                setAttributes: (attrs) => {\n                    const {width, maxHeight, allowInteract, showRenderProgress} = attrs;\n                    embedding.setAttributes({width, maxHeight, allowInteract, showRenderProgress});\n                }\n            };\n        });\n}\n"],"names":["Promise","promiseFinally","globalNS","self","window","global","Error","PromisePolyfill","installedScripts","libraryLoading","counter","isStyleInsertionPatched","insertedStyles","styleInsertionCallbacks","installScript","url","script","document","createElement","type","src","head","getElementsByTagName","appendChild","loadLibrary","libraryURL","resolve","reject","onerror","callbackName","lib","split","s","separators","before","after","i","length","sep","index","indexOf","substring","isNotebookStyleElement","element","domains","name","tagName","toLowerCase","rel","some","domain","href","startsWith","dataset","isWolframNotebookStyle","id","patchShadowStyleInsertion","container","callback","styleElement","didInsertWithoutCloning","cloneNode","originalAppendChild","child","push","forEach","call","existingStyle","splice","getNotebookData","remainingPaths","path","embeddingAPI","req","XMLHttpRequest","addEventListener","status","text","responseText","data","JSON","parse","notebookID","mainScript","otherScripts","map","stylesheetDomains","open","send","defaultValue","value","fallback","undefined","embed","node","options","theNotebookID","theOptions","useShadowDOM","useShadow","attachShadow","shadowRoot","containerNodes","cleanupHandlers","onContainerDimensionsChange","width","height","containerNode","style","then","shadowHost","mode","Object","defineProperty","createElementNS","createTextNode","createDocumentFragment","documentElement","defaultView","cleanup","maxHeight","Infinity","allowInteract","showRenderProgress","embedding","detach","setAttributes","attrs"],"mappings":"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"}